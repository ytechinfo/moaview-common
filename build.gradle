/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.0.1/userguide/java_library_plugin.html
 */

plugins {
    // Apply the java-library plugin to add support for Java Library
    id 'java'
    id 'war'
    id 'eclipse'
    id 'java-library'
    id 'maven-publish'
    id 'signing'
}

repositories {
    // Use jcenter for resolving dependencies.
    // You can declare any Maven/Ivy/file repository here.
    mavenCentral()
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

task initSourceFolders {
    sourceSets*.java.srcDirs*.each {
        if( !it.exists() ) {
            it.mkdirs()
        }
    }
    
    sourceSets*.resources.srcDirs*.each {
        if( !it.exists() ) {
            it.mkdirs()
        }
    }
}

def def_version = [
	junit : '5.2.0'
	,junitPlatform : '1.5.0'
	,jspApi : '2.3.3'
	,jackson : '2.9.9'
]

dependencies {
   //junit
	testImplementation(
		 [ group: 'org.junit.jupiter' , name: 'junit-jupiter-api' , version: def_version.junit ]
		,[ group: 'org.junit.jupiter' , name: 'junit-jupiter-engine' , version: def_version.junit ]
		,[ group: 'org.junit.jupiter' , name: 'junit-jupiter-params' , version: def_version.junit ]
		,[ group: 'org.junit.vintage' , name: 'junit-vintage-engine' , version: def_version.junit ]
		
		,[ group: 'org.junit.platform' , name: 'junit-platform-launcher' , version: def_version.junitPlatform ]
		,[ group: 'org.junit.platform' , name: 'junit-platform-runner' , version: def_version.junitPlatform ]
	)
	
	implementation( // apache.commons
		[ group: 'org.apache.commons' , name: 'commons-collections4' , version: '4.4']
		,[ group: 'org.apache.commons' , name: 'commons-lang3' , version: '3.9']
	)
	
	implementation group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version:  def_version.jackson 
	
	providedCompile(
		[ group: 'javax.servlet', name: 'javax.servlet-api', version: '3.1.0' ]
		,[ group: 'javax.portlet', name: 'portlet-api', version: '3.0.0']
		,[ group: 'javax.servlet.jsp', name: 'javax.servlet.jsp-api', version: def_version.jspApi ]
	)
	
}

test {
    useJUnitPlatform()
}

task generateCode {
    doLast {
        println 'Generating some code...'
    }
}

task generateCustomConfig {
    doLast {
          println "Generating custom configuration..."
    }
}
	
eclipse { // 이클립스 project facets설정.
	//프로젝트를 가져 오거나 동기화
	synchronizationTasks generateCustomConfig
	
	// 자동 빌드
	autoBuildTasks generateCode
	
	classpath {
        defaultOutputDir = file("target-notused")
        file.whenMerged {
            entries.each { entry ->
                if (entry.kind == 'src' && entry.hasProperty('output')) {
                    entry.output = entry.output.replace('bin/', "target/")
                }
            }
        }
    }
}

// JAVA file compile charset
[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'
